<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Solutions | STATS5099 Data Mining and Machine Learning</title>
  <meta name="description" content="5 Solutions | STATS5099 Data Mining and Machine Learning" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Solutions | STATS5099 Data Mining and Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Solutions | STATS5099 Data Mining and Machine Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercise-3-employment-in-europe.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to DMML Lab 2</a></li>
<li class="chapter" data-level="2" data-path="exercise-1-tasks-in-lecture-notes.html"><a href="exercise-1-tasks-in-lecture-notes.html"><i class="fa fa-check"></i><b>2</b> Exercise 1: Tasks in lecture notes</a></li>
<li class="chapter" data-level="3" data-path="exercise-2-identifying-letters-of-alphabet.html"><a href="exercise-2-identifying-letters-of-alphabet.html"><i class="fa fa-check"></i><b>3</b> Exercise 2: Identifying letters of alphabet</a></li>
<li class="chapter" data-level="4" data-path="exercise-3-employment-in-europe.html"><a href="exercise-3-employment-in-europe.html"><i class="fa fa-check"></i><b>4</b> Exercise 3: Employment in Europe</a></li>
<li class="chapter" data-level="5" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>5</b> Solutions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="solutions.html"><a href="solutions.html#task-1"><i class="fa fa-check"></i><b>5.1</b> Task 1</a></li>
<li class="chapter" data-level="5.2" data-path="solutions.html"><a href="solutions.html#task-2"><i class="fa fa-check"></i><b>5.2</b> Task 2</a></li>
<li class="chapter" data-level="5.3" data-path="solutions.html"><a href="solutions.html#task-3"><i class="fa fa-check"></i><b>5.3</b> Task 3</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STATS5099 Data Mining and Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solutions" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Solutions<a href="solutions.html#solutions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="task-1" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Task 1<a href="solutions.html#task-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The steps for implementing Sammon mapping are similar to implementing metric MDS, that is, we need to first convert the inter-correlations into a dissimilarity matrix and then apply the <code>sammon</code> command.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="solutions.html#cb6-1" tabindex="-1"></a><span class="fu">library</span>(MASS);<span class="fu">library</span>(smacof)</span>
<span id="cb6-2"><a href="solutions.html#cb6-2" tabindex="-1"></a>crime.dist <span class="ot">&lt;-</span> <span class="fu">sim2diss</span>(crimes, <span class="at">method=</span><span class="st">&quot;corr&quot;</span>)</span>
<span id="cb6-3"><a href="solutions.html#cb6-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb6-4"><a href="solutions.html#cb6-4" tabindex="-1"></a>crime.sm<span class="ot">&lt;-</span><span class="fu">sammon</span>(crime.dist,<span class="at">k=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Initial stress        : 0.06663
## stress after  10 iters: 0.02557, magic = 0.500
## stress after  20 iters: 0.02554, magic = 0.500</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="solutions.html#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(crime.sm<span class="sc">$</span>points,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb8-2"><a href="solutions.html#cb8-2" tabindex="-1"></a><span class="fu">text</span>(crime.sm<span class="sc">$</span>points,<span class="at">labels=</span><span class="fu">names</span>(crimes))</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" />
The plot is quite similar to the result obtained from metric MDS, except that the distance between Murder and Assault increases slightly.</p>
</div>
<div id="task-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Task 2<a href="solutions.html#task-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: lower-alpha">
<li><p>The data is in a format of the proximity matrix rather than the data matrix. Therefore, PCA is not suitable.</p></li>
<li><p>A larger value indicates that two letters are more likely to cause confusion and thus more similar.</p></li>
<li><p>As this is a similarity matrix, the first step is to convert the data into a dissimilarity matrix.</p></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="solutions.html#cb9-1" tabindex="-1"></a><span class="fu">library</span>(smacof)</span>
<span id="cb9-2"><a href="solutions.html#cb9-2" tabindex="-1"></a>letter <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;letter.csv&quot;</span>, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb9-3"><a href="solutions.html#cb9-3" tabindex="-1"></a>letter.dist <span class="ot">&lt;-</span> <span class="fu">sim2diss</span>(letter, <span class="at">method=</span><span class="fu">max</span>(letter)) <span class="co">#z-s_ij</span></span>
<span id="cb9-4"><a href="solutions.html#cb9-4" tabindex="-1"></a>letter.dist <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(letter.dist)</span>
<span id="cb9-5"><a href="solutions.html#cb9-5" tabindex="-1"></a>letter.dist</span></code></pre></div>
<pre><code>##    C  D  G  H  M  N  Q
## D 15                  
## G  8 18               
## H 18 16 17            
## M 18 17 18  1         
## N 18 16 19  2  4      
## Q 11  0 11 19 18 12   
## W 19 15 18 15  2  7 16</code></pre>
<p>Because we have deduced dissimilarities from similarities, the absolute dissimilarities <span class="math inline">\(\delta_ij\)</span> depend on the value of personally chosen <span class="math inline">\(z\)</span>. This is the case where the non-metric MDS makes most sense.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="solutions.html#cb11-1" tabindex="-1"></a><span class="co">#nonmetric MDS</span></span>
<span id="cb11-2"><a href="solutions.html#cb11-2" tabindex="-1"></a><span class="co">#2D</span></span>
<span id="cb11-3"><a href="solutions.html#cb11-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb11-4"><a href="solutions.html#cb11-4" tabindex="-1"></a>letter.nmds2 <span class="ot">&lt;-</span> <span class="fu">mds</span>(letter.dist, <span class="at">ndim=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;ordinal&quot;</span>)</span>
<span id="cb11-5"><a href="solutions.html#cb11-5" tabindex="-1"></a><span class="fu">plot</span>(letter.nmds2,<span class="at">asp=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="solutions.html#cb12-1" tabindex="-1"></a><span class="fu">plot</span>(letter.nmds2,<span class="at">plot.type=</span><span class="st">&quot;Shepard&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="solutions.html#cb13-1" tabindex="-1"></a>letter.nmds2<span class="sc">$</span>stress</span></code></pre></div>
<pre><code>## [1] 0.05971</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="solutions.html#cb15-1" tabindex="-1"></a><span class="co"># Kruskal (1964) gave following advise about stress values based on his experience:</span></span>
<span id="cb15-2"><a href="solutions.html#cb15-2" tabindex="-1"></a><span class="co"># Stress Goodness-of-fit</span></span>
<span id="cb15-3"><a href="solutions.html#cb15-3" tabindex="-1"></a><span class="co"># 0.200  poor</span></span>
<span id="cb15-4"><a href="solutions.html#cb15-4" tabindex="-1"></a><span class="co"># 0.100  fair</span></span>
<span id="cb15-5"><a href="solutions.html#cb15-5" tabindex="-1"></a><span class="co"># 0.050  good</span></span>
<span id="cb15-6"><a href="solutions.html#cb15-6" tabindex="-1"></a><span class="co"># 0.025  excellent</span></span>
<span id="cb15-7"><a href="solutions.html#cb15-7" tabindex="-1"></a><span class="co"># 0.000  perfect</span></span>
<span id="cb15-8"><a href="solutions.html#cb15-8" tabindex="-1"></a><span class="co"># More recent articles caution against using a table like this since acceptable values of stress depends on the quality of the distance matrix and the number of objects in that matrix.</span></span></code></pre></div>
<p>Let's try reducing the data to 3 dimensions.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="solutions.html#cb16-1" tabindex="-1"></a><span class="co">#3D</span></span>
<span id="cb16-2"><a href="solutions.html#cb16-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-3"><a href="solutions.html#cb16-3" tabindex="-1"></a>letter.nmds3 <span class="ot">&lt;-</span> <span class="fu">mds</span>(letter.dist, <span class="at">ndim=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">&quot;ordinal&quot;</span>)</span>
<span id="cb16-4"><a href="solutions.html#cb16-4" tabindex="-1"></a><span class="fu">library</span>(rgl)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;rgl&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plotrix&#39;:
## 
##     mtext3d</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="solutions.html#cb19-1" tabindex="-1"></a><span class="co"># plot3d(letter.nmds3$conf[,1],letter.nmds3$conf[,2],</span></span>
<span id="cb19-2"><a href="solutions.html#cb19-2" tabindex="-1"></a><span class="co">#        letter.nmds3$conf[,3],type=&quot;&quot;,</span></span>
<span id="cb19-3"><a href="solutions.html#cb19-3" tabindex="-1"></a><span class="co">#        xlab=&quot;Axis 1&quot;,ylab=&quot;Axis 2&quot;,zlab=&quot;Axis 3&quot;,asp=1)</span></span>
<span id="cb19-4"><a href="solutions.html#cb19-4" tabindex="-1"></a><span class="fu">text3d</span>(letter.nmds3<span class="sc">$</span>conf[,<span class="dv">1</span>],letter.nmds3<span class="sc">$</span>conf[,<span class="dv">2</span>],</span>
<span id="cb19-5"><a href="solutions.html#cb19-5" tabindex="-1"></a>       letter.nmds3<span class="sc">$</span>conf[,<span class="dv">3</span>],<span class="at">texts=</span><span class="fu">names</span>(letter.dist),<span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb19-6"><a href="solutions.html#cb19-6" tabindex="-1"></a><span class="fu">plot</span>(letter.nmds3,<span class="at">plot.type=</span><span class="st">&quot;Shepard&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="solutions.html#cb20-1" tabindex="-1"></a>letter.nmds3<span class="sc">$</span>stress</span></code></pre></div>
<pre><code>## [1] 0.01758</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>To produce the scree plot, we need to compute the stress value for each dimension.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="solutions.html#cb22-1" tabindex="-1"></a>N_dim <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(letter)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb22-2"><a href="solutions.html#cb22-2" tabindex="-1"></a>letter.nmds <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(N_dim),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb22-3"><a href="solutions.html#cb22-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> N_dim){</span>
<span id="cb22-4"><a href="solutions.html#cb22-4" tabindex="-1"></a>  letter.nmds[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb22-5"><a href="solutions.html#cb22-5" tabindex="-1"></a>  letter.nmds[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mds</span>(letter.dist, <span class="at">ndim=</span>i, <span class="at">type=</span><span class="st">&quot;ordinal&quot;</span>)<span class="sc">$</span>stress </span>
<span id="cb22-6"><a href="solutions.html#cb22-6" tabindex="-1"></a>}</span>
<span id="cb22-7"><a href="solutions.html#cb22-7" tabindex="-1"></a><span class="fu">plot</span>(letter.nmds, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">main=</span><span class="st">&quot;scree plot&quot;</span>, </span>
<span id="cb22-8"><a href="solutions.html#cb22-8" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;number of dimensions&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;stress-1&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>The scree plot suggests that using three dimensions could give a relatively small stress value.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li><p>Based on the 3D plot in (c), one might argue that C, D, G, Q forms a cluster and H, M, N, W forms another cluster.</p></li>
<li><p>When converting confusion to distance, we have introduced the parameter <span class="math inline">\(z\)</span> (maximum value to be subtracted from). Now we will create a function to investigate the effect of <span class="math inline">\(z\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="solutions.html#cb23-1" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">max</span>(letter), <span class="at">by=</span><span class="dv">1</span>, <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb23-2"><a href="solutions.html#cb23-2" tabindex="-1"></a>letter.z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(Z), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb23-3"><a href="solutions.html#cb23-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Z)){</span>
<span id="cb23-4"><a href="solutions.html#cb23-4" tabindex="-1"></a>  letter.dist <span class="ot">&lt;-</span> <span class="fu">sim2diss</span>(letter, <span class="at">method=</span>Z[i])</span>
<span id="cb23-5"><a href="solutions.html#cb23-5" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb23-6"><a href="solutions.html#cb23-6" tabindex="-1"></a>  letter.z[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> Z[i]</span>
<span id="cb23-7"><a href="solutions.html#cb23-7" tabindex="-1"></a>  letter.z[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mds</span>(letter.dist, <span class="at">ndim=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">&quot;ordinal&quot;</span>)<span class="sc">$</span>stress </span>
<span id="cb23-8"><a href="solutions.html#cb23-8" tabindex="-1"></a>}</span>
<span id="cb23-9"><a href="solutions.html#cb23-9" tabindex="-1"></a><span class="fu">plot</span>(letter.z, <span class="at">xlab=</span><span class="st">&quot;integer z&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;stress-1&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>It is clear that <span class="math inline">\(z\)</span> has a large influence on the stress value.</p>
<ol start="7" style="list-style-type: lower-alpha">
<li>To test the sensitivity to initial configuration, we need to change the current way of initialisation, which is classical MDS by default. Specially, we need to use the argument: <code>init="random"</code></li>
</ol>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="solutions.html#cb24-1" tabindex="-1"></a>Seed <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb24-2"><a href="solutions.html#cb24-2" tabindex="-1"></a>letter.seed <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(Seed), <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb24-3"><a href="solutions.html#cb24-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> Seed){</span>
<span id="cb24-4"><a href="solutions.html#cb24-4" tabindex="-1"></a>  letter.dist <span class="ot">&lt;-</span> <span class="fu">sim2diss</span>(letter, <span class="at">method=</span><span class="fu">max</span>(letter))</span>
<span id="cb24-5"><a href="solutions.html#cb24-5" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb24-6"><a href="solutions.html#cb24-6" tabindex="-1"></a>  letter.seed[i] <span class="ot">&lt;-</span> <span class="fu">mds</span>(letter.dist,<span class="at">ndim=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">&quot;ordinal&quot;</span>, <span class="at">init=</span><span class="st">&quot;random&quot;</span>)<span class="sc">$</span>stress </span>
<span id="cb24-7"><a href="solutions.html#cb24-7" tabindex="-1"></a>}</span>
<span id="cb24-8"><a href="solutions.html#cb24-8" tabindex="-1"></a><span class="fu">hist</span>(letter.seed, <span class="at">xlab=</span><span class="st">&quot;stress value&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram of stress values computed over 100 random initialisations&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="task-3" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Task 3<a href="solutions.html#task-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: lower-alpha">
<li>As the variables have different variances, it would be better to use standardised variables when computing the pairwise distances.</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="solutions.html#cb25-1" tabindex="-1"></a><span class="fu">apply</span>(employ,<span class="dv">2</span>,var)</span></code></pre></div>
<pre><code>##    AGRIC   MINING     MANU    POWER   CONSTR  SERVICE  FINANCE   SOCIAL 
## 241.6958   0.9410  49.1087   0.1415   2.7080  20.9329   7.8768  46.6426 
##    TRANS 
##   1.9362</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="solutions.html#cb27-1" tabindex="-1"></a>employ.sd <span class="ot">&lt;-</span> <span class="fu">scale</span>(employ)</span>
<span id="cb27-2"><a href="solutions.html#cb27-2" tabindex="-1"></a>employ.dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(employ.sd) <span class="co">#to visualise countries as data points</span></span>
<span id="cb27-3"><a href="solutions.html#cb27-3" tabindex="-1"></a>employ.dist.var <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">t</span>(employ.sd)) <span class="co">#to visualise variables as data points</span></span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>As we have created the distance matrix directly from the data, metric MDS would be a better choice.</p></li>
<li><p>There are three types of metric MDS covered in the lecture.</p></li>
</ol>
<p>Classical MDS (<code>cmdscale</code>) is omitted as it is equivalent to PCA (check that!)</p>
<p>Metric MDS can be computed using <code>mds</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="solutions.html#cb28-1" tabindex="-1"></a><span class="fu">library</span>(smacof)</span>
<span id="cb28-2"><a href="solutions.html#cb28-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb28-3"><a href="solutions.html#cb28-3" tabindex="-1"></a>employ.mds2 <span class="ot">&lt;-</span> <span class="fu">mds</span>(employ.dist, <span class="at">ndim=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;interval&quot;</span>)</span>
<span id="cb28-4"><a href="solutions.html#cb28-4" tabindex="-1"></a><span class="fu">plot</span>(employ.mds2)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="solutions.html#cb29-1" tabindex="-1"></a><span class="fu">plot</span>(employ.mds2,<span class="at">plot.type=</span><span class="st">&quot;Shepard&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<p>The Shepard diagram suggests that a lot of information was lost when using only two dimensions.</p>
<p>To select the optimal number of dimensions, scree plot is generated.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="solutions.html#cb30-1" tabindex="-1"></a>employ.mds <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">nrow</span>(employ)<span class="sc">-</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb30-2"><a href="solutions.html#cb30-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(employ)<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb30-3"><a href="solutions.html#cb30-3" tabindex="-1"></a>  employ.mds[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb30-4"><a href="solutions.html#cb30-4" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb30-5"><a href="solutions.html#cb30-5" tabindex="-1"></a>  employ.mds[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mds</span>(employ.dist, <span class="at">ndim=</span>i, <span class="at">type=</span><span class="st">&quot;interval&quot;</span>)<span class="sc">$</span>stress</span>
<span id="cb30-6"><a href="solutions.html#cb30-6" tabindex="-1"></a>}</span>
<span id="cb30-7"><a href="solutions.html#cb30-7" tabindex="-1"></a><span class="fu">plot</span>(employ.mds, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">main=</span><span class="st">&quot;scree plot&quot;</span>, </span>
<span id="cb30-8"><a href="solutions.html#cb30-8" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;number of dimensions&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;stress&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Here is a difficult case where there is no clear cut-off point. Depending on the purpose of the study, 4-8 dimensions seem to be a reasonable range.</p>
<p>When implementing Sammon mapping, there are a few differences which are explained below.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="solutions.html#cb31-1" tabindex="-1"></a><span class="co">#Sammon</span></span>
<span id="cb31-2"><a href="solutions.html#cb31-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb31-3"><a href="solutions.html#cb31-3" tabindex="-1"></a>employ.sm <span class="ot">&lt;-</span> <span class="fu">sammon</span>(employ.dist, <span class="at">k=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Initial stress        : 0.12723
## stress after  10 iters: 0.06316, magic = 0.092
## stress after  20 iters: 0.04799, magic = 0.500
## stress after  30 iters: 0.04667, magic = 0.500
## stress after  40 iters: 0.04664, magic = 0.500</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="solutions.html#cb33-1" tabindex="-1"></a><span class="fu">plot</span>(employ.sm<span class="sc">$</span>points, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Axis 1&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Axis 2&quot;</span>,<span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb33-2"><a href="solutions.html#cb33-2" tabindex="-1"></a><span class="fu">text</span>(employ.sm<span class="sc">$</span>points, <span class="at">labels=</span><span class="fu">names</span>(employ.dist))</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>As <code>sammon</code> is not from the <code>smacof</code> library, we cannot easily plot the Shepard diagram by setting <code>plot.type="Shepard"</code>. Instead, an additional command <code>Shepard</code> is needed to produce the Shepard diagram.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="solutions.html#cb34-1" tabindex="-1"></a>employ.sh<span class="ot">&lt;-</span><span class="fu">Shepard</span>(employ.dist, employ.sm<span class="sc">$</span>points, <span class="at">p=</span><span class="dv">2</span>)</span>
<span id="cb34-2"><a href="solutions.html#cb34-2" tabindex="-1"></a><span class="fu">plot</span>(employ.sh, <span class="at">pch=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb34-3"><a href="solutions.html#cb34-3" tabindex="-1"></a><span class="fu">lines</span>(employ.sh<span class="sc">$</span>x, employ.sh<span class="sc">$</span>yf, <span class="at">type =</span> <span class="st">&quot;S&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<ol start="5" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>There is no clear group structure when applying metric MDS or Sammon mapping on the dissimilarity matrix computed over countries. Turkey seems to locate slightly far away from the remaining countries.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>You can perform the above analysis again, but using <code>employ.dist.var</code> as the input to MDS methods.</li>
</ol>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-3-employment-in-europe.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
